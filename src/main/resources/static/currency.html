<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Currency Converter</title>
  <style>
    :root {
      --bg: #0f172a;
      --card: #0b1220;
      --accent: #06b6d4;
      --muted: #94a3b8;
      --glass: rgba(255,255,255,0.03);
    }
    * { 
    	box-sizing: border-box; 
    	font-family: Inter, system-ui, Arial; 
    }
    
    body {
      margin:0; 
      min-height:100vh; 
      display:flex; 
      align-items:center; 
      justify-content:center;
      background: pink;
      color:#e6eef6;
      padding:24px;
    }
    
    .card {
      width:360px; 
      max-width:95vw; 
      background:var(--card); 
      border-radius:12px; 
      padding:20px;
      box-shadow: 0 6px 30px rgba(3,7,18,0.6);
    }
    
    h1 { 
    	margin:0 0 12px 0; 
    	font-size:20px; 
    	letter-spacing:0.2px;
    	text-align:center; 
    }
    
    label { 
    	display:block; 
    	font-size:12px; 
    	color:var(--muted); 
    	margin-top:10px; 
    }
    
    .row { 
    	display:flex; 
    	gap:8px; 
    	margin-top:8px; 
    }
    
    select,input[type="number"]{
    	width:100%; 
    	padding:10px 12px; 
    	border-radius:8px; 
    	background:var(--glass); 
    	border:1px solid rgba(255,255,255,0.04);
        color:var(--muted); outline:none; font-size:14px;
    }
    
    button {
      margin-top:14px; 
      width:100%; 
      padding:10px 14px; 
      border-radius:10px; 
      border:none;
      background:linear-gradient(90deg,var(--accent),#06b6b4); color:#032027; font-weight:700; cursor:pointer;
      box-shadow: 0 6px 18px rgba(6,182,212,0.12);
    }
    .result {
      margin-top:14px; 
      padding:12px; 
      border-radius:8px; 
      background: rgba(255,255,255,0.02);
      font-size:15px; color:#dff8fb;
    }
    .small { 
    	font-size:13px; 
    	color:var(--muted); 
    	margin-top:8px; 
    }
    .error { 
    	margin-top:10px; 
    	color:#ffb4b4; 
    	background:rgba(255,100,100,0.06); 
    	padding:8px; 
    	border-radius:6px; 
    }
    .spinner { 
    	display:inline-block; 
    	width:14px; 
    	height:14px; 
    	border:2px solid rgba(255,255,255,0.12); 
    	border-top-color:var(--accent); 
    	border-radius:50%; animation:spin .8s linear infinite; 
    	vertical-align:middle; 
    	margin-right:8px; 
    }
    
    @keyframes spin { 
    	to { 
    		transform:rotate(360deg); 
    	} 
    }
    
    footer { 
    margin-top:12px; 
    font-size:12px; 
    color:var(--muted); 
    text-align:center; 
   }
   
  </style>
</head>
<body>
  <div class="card" role="main">
    <h1>Currency Converter</h1>

    <label for="from">From</label>
    <select id="from">
      <option>USD</option>
      <option>EUR</option>
      <option>INR</option>
      <option>GBP</option>
      <option>JPY</option>
      <option>AUD</option>
      <option>CAD</option>
      <option>SGD</option>
    </select>

    <label for="to">To</label>
    <select id="to">
      <option>INR</option>
      <option>USD</option>
      <option>EUR</option>
      <option>GBP</option>
      <option>JPY</option>
      <option>AUD</option>
      <option>CAD</option>
      <option>SGD</option>
    </select>

    <label for="amount">Amount</label>
    <div class="row">
      <input id="amount" type="number" step="any" min="0" value="10" />
    </div>

    <button id="convertBtn">Convert</button>

    <div id="status" class="small"></div>
    <div id="result" class="result" style="display:none;"></div>
    <div id="errorBox" class="error" style="display:none;"></div>

  </div>

  <script>
    const fromEl = document.getElementById('from');
    const toEl = document.getElementById('to');
    const amountEl = document.getElementById('amount');
    const btn = document.getElementById('convertBtn');
    const status = document.getElementById('status');
    const resultDiv = document.getElementById('result');
    const errorBox = document.getElementById('errorBox');

    const BACKEND = '/';


    function showLoading(msg='Loading...') {
      status.innerHTML = `<span class="spinner"></span> ${msg}`;
      btn.disabled = true;
      errorBox.style.display='none';
      resultDiv.style.display='none';
    }
    function hideLoading() {
      status.textContent = '';
      btn.disabled = false;
    }
    function showError(msg) {
      errorBox.style.display='block';
      errorBox.textContent = msg;
    }
    function showResult(data) {
      resultDiv.style.display = 'block';
      resultDiv.innerHTML = `<strong>${data.amount} ${data.from}</strong> = <strong>${Number(data.converted).toLocaleString(undefined, {maximumFractionDigits:6})} ${data.to}</strong>
        <div class="small">Rate used: 1 ${data.from} = ${(data.converted / data.amount).toFixed(6)} ${data.to}</div>`;
    }

    btn.addEventListener('click', async () => {
      const from = fromEl.value.trim();
      const to = toEl.value.trim();
      const amount = amountEl.value;

      if (!from || !to || !amount || Number(amount) <= 0) {
        showError('Please enter a valid amount and currencies.');
        return;
      }

      showLoading('Converting...');
      try {
        const url = `${BACKEND}?from=${encodeURIComponent(from)}&to=${encodeURIComponent(to)}&amount=${encodeURIComponent(amount)}`;
        const resp = await fetch(url);
        const json = await resp.json();

        hideLoading();

        if (!resp.ok) {
          // backend returns JSON {error: "..."}
          if (json && json.error) showError(json.error);
          else showError('Server error: ' + resp.status);
          return;
        }

        // Expecting { from, to, amount, converted }
        showResult(json);
      } catch (err) {
        hideLoading();
        showError('Network error: ' + (err.message || err));
      }
    });

    // optional: press Enter in amount to convert
    amountEl.addEventListener('keydown', (e) => { if (e.key === 'Enter') btn.click(); });
  </script>
</body>
</html>
